<!DOCTYPE html>
<html>
<head>
  <title>Cookie Format Converter</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    textarea { width: 100%; height: 150px; }
    select, button { padding: 8px; margin-top: 10px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; }
    th { background: #f2f2f2; }
  </style>
</head>
<body>

<h2>Cookie Format Converter</h2>

<textarea id="cookieInput" placeholder="Paste your cookies here..."></textarea>
<br>

<select id="convertTo">
  <option value="json">Convert to JSON</option>
  <option value="netscape">Convert to Netscape</option>
  <option value="header">Convert to Header String</option>
  <option value="raw">Convert to RAW</option>
</select>

<br>
<button onclick="convertCookies()">Convert</button>
<button onclick="copyOutput()">Copy Output</button>

<h3>Output</h3>
<textarea id="output"></textarea>

<script>
function detectFormat(input) {
  input = input.trim();

  if (input.startsWith("{") || input.startsWith("[")) return "json";
  if (input.includes("\t")) return "netscape";
  if (input.includes("=") && input.includes(";")) return "header";
  if (input.includes("=")) return "raw";

  return "unknown";
}

function parseToArray(input) {
  const format = detectFormat(input);
  let cookies = [];

  if (format === "json") {
    cookies = JSON.parse(input);
  }

  else if (format === "netscape") {
    const lines = input.split("\n");
    lines.forEach(line => {
      if (!line.startsWith("#") && line.trim()) {
        const parts = line.split("\t");
        cookies.push({
          domain: parts[0],
          name: parts[5],
          value: parts[6]
        });
      }
    });
  }

  else if (format === "header" || format === "raw") {
    const pairs = input.split(";");
    pairs.forEach(pair => {
      const [name, value] = pair.split("=");
      if (name && value) {
        cookies.push({
          name: name.trim(),
          value: value.trim()
        });
      }
    });
  }

  return cookies;
}

function convertCookies() {
  const input = document.getElementById("cookieInput").value;
  const target = document.getElementById("convertTo").value;

  try {
    const cookies = parseToArray(input);
    let output = "";

    if (target === "json") {
      output = JSON.stringify(cookies, null, 2);
    }

    else if (target === "header") {
      output = cookies.map(c => `${c.name}=${c.value}`).join("; ");
    }

    else if (target === "raw") {
      output = cookies.map(c => `${c.name}=${c.value}`).join("\n");
    }

    else if (target === "netscape") {
      output = "# Netscape HTTP Cookie File\n";
      cookies.forEach(c => {
        output += `${c.domain || "example.com"}\tTRUE\t/\tFALSE\t0\t${c.name}\t${c.value}\n`;
      });
    }

    document.getElementById("output").value = output;

  } catch (e) {
    document.getElementById("output").value = "Invalid format";
  }
}

function copyOutput() {
  const output = document.getElementById("output");
  output.select();
  document.execCommand("copy");
  alert("Copied!");
}
</script>

</body>
</html>
